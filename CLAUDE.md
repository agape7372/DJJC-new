# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## CRITICAL: Thinking Mode

**ëª¨ë“  ì‘ë‹µì— "ultrathink"ë¥¼ ì ìš©í•˜ë¼.** ë³µì¡í•œ ë¬¸ì œë¥¼ ë‹¤ë£° ë•Œ ê¹Šì´ ìˆëŠ” ì‚¬ê³ ì™€ ë¶„ì„ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤. ë‹¨ìˆœí•œ ë‹µë³€ì´ ì•„ë‹Œ, ì¶©ë¶„í•œ ê³ ë¯¼ê³¼ ê²€í† ë¥¼ ê±°ì¹œ ì‘ë‹µì„ ì œê³µí•˜ë¼.

## CRITICAL: Progress Tracking

**ê°œë°œ ì§„í–‰ ì‹œ ë°˜ë“œì‹œ `progress.md`ë¥¼ ì—…ë°ì´íŠ¸í•˜ë¼.**
- ìƒˆë¡œìš´ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ ì‹œ í•´ë‹¹ Phaseì— ì²´í¬ í‘œì‹œ
- ìƒˆë¡œìš´ íŒŒì¼ ìƒì„± ì‹œ í•´ë‹¹ Phaseì˜ íŒŒì¼ ëª©ë¡ì— ì¶”ê°€
- ìƒˆë¡œìš´ Phase ì‹œì‘ ì‹œ Phase ì„¹ì…˜ ì¶”ê°€
- ì™„ë£Œëœ Phaseì—ëŠ” ì™„ë£Œì¼ í‘œì‹œ

## Commands

```bash
npm run dev      # ê°œë°œ ì„œë²„ ì‹¤í–‰ (Vite)
npm run build    # í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run preview  # ë¹Œë“œ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
npm run test     # Vitest í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```

## Project Overview

**ë‘ë°”ì´ ì«€ë“ ì¿ í‚¤ íƒ€ì´ì¿¤ (Dubai Chewy Cookie Tycoon)** - ëª¨ë°”ì¼ íƒ€ì´ì¿¤ ê²Œì„

í”Œë ˆì´ì–´ê°€ ë§í•´ê°€ëŠ” ì¹´í˜ë¥¼ ì¸ìˆ˜ë°›ì•„ ë°”ì´ëŸ´ íˆíŠ¸ ìƒí’ˆ "ë‘ì«€ì¿ "ë¥¼ ë§Œë“¤ì–´ ì¬ë²Œì´ ë˜ëŠ” ê²ƒì´ ëª©í‘œ.

## Architecture

í”„ë¡œì íŠ¸ëŠ” ë‘ ê°€ì§€ ì•„í‚¤í…ì²˜ë¥¼ ë³‘í–‰:

### 1. Vanilla Canvas ì—”ì§„ (src/)

```
src/
â”œâ”€â”€ main.js              # ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸
â”œâ”€â”€ core/                # ê²Œì„ ì—”ì§„ ì½”ì–´
â”‚   â”œâ”€â”€ Game.js          # ë©”ì¸ ê²Œì„ í´ë˜ìŠ¤ (ë£¨í”„, ë Œë”ë§)
â”‚   â”œâ”€â”€ StateManager.js  # ìƒíƒœ ë¨¸ì‹ 
â”‚   â”œâ”€â”€ InputManager.js  # í„°ì¹˜/ë§ˆìš°ìŠ¤ ì…ë ¥
â”‚   â”œâ”€â”€ SoundManager.js  # Web Audio API í”„ë¡œì‹œì €ëŸ´ ì‚¬ìš´ë“œ
â”‚   â””â”€â”€ TimeManager.js   # ì—ë„ˆì§€/ì‹œê°„ëŒ€/ìš”ì¼ ì‹œìŠ¤í…œ
â”œâ”€â”€ states/              # ê²Œì„ ìƒíƒœ (TitleState, ShopState, PrepState ë“±)
â””â”€â”€ utils/Storage.js     # localStorage ë˜í¼
```

### 2. Phaser.js ì—”ì§„ (src/phaser/) - v2.0.0

```
src/phaser/
â”œâ”€â”€ main.js              # Phaser ì—”íŠ¸ë¦¬ (window.debug í—¬í¼ í¬í•¨)
â”œâ”€â”€ config/GameConfig.js # ê²Œì„ ì„¤ì •, ìƒ‰ìƒ, í°íŠ¸, ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ managers/
â”‚   â”œâ”€â”€ GameManager.js   # ì‹±ê¸€í†¤ ìƒíƒœ ê´€ë¦¬ (ê³¨ë“œ, ì¸ë²¤í† ë¦¬, í†µê³„)
â”‚   â”œâ”€â”€ EventEmitter.js  # ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ EffectsManager.js
â”œâ”€â”€ scenes/
â”‚   â”œâ”€â”€ BootScene.js     # ì´ˆê¸°í™”/ë¡œë”©
â”‚   â”œâ”€â”€ CounterScene.js  # ì¹´ìš´í„° (ì†ë‹˜ ì‘ëŒ€)
â”‚   â”œâ”€â”€ KitchenScene.js  # ì£¼ë°© (ì¿ í‚¤ ì œì‘)
â”‚   â”œâ”€â”€ UIScene.js       # UI ì˜¤ë²„ë ˆì´
â”‚   â””â”€â”€ minigames/       # ë¯¸ë‹ˆê²Œì„ 4ì¢…
â”‚       â”œâ”€â”€ KadaifSliceScene.js
â”‚       â”œâ”€â”€ PistachioCrushScene.js
â”‚       â”œâ”€â”€ MarshmallowMeltScene.js
â”‚       â””â”€â”€ CocoaHelixScene.js
â””â”€â”€ prefabs/             # ê²Œì„ ì˜¤ë¸Œì íŠ¸ (Customer, Ingredient, Cookie)
```

**Phaser Scene íë¦„:** `BootScene â†’ CounterScene â†” KitchenScene (UIScene ì˜¤ë²„ë ˆì´)`

## Core Game Flow

```
[TITLE] â†’ [INTRO] â†’ [SHOP] (í—ˆë¸Œ)
                       â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ğŸ  ê°€ê²Œ í—ˆë¸Œ (ShopState)    â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ ğŸ§‘â€ğŸ³ ì¿ í‚¤ ë§Œë“¤ê¸° â†’ [PREP]    â”‚
         â”‚ ğŸ“– ë ˆì‹œí”¼ë¶ â†’ [RECIPE_BOOK] â”‚
         â”‚ ğŸ’¸ íŒë§¤í•˜ê¸° â†’ [SELL]        â”‚
         â”‚ ğŸ“¦ ì¬ê³  í™•ì¸                â”‚
         â”‚ â¬†ï¸ ì—…ê·¸ë ˆì´ë“œ               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¿ í‚¤ ì œì‘ í”Œë¡œìš°:
[PREP] â†’ [BAKING] â†’ [DECO] â†’ [TASTING] â†’ [SHOP] (ì¿ í‚¤ê°€ ì¬ê³ ì— ì¶”ê°€ë¨)
```

## Key Systems

### 1. ì¿ í‚¤ ìŠ¤íƒ¯ (Game.cookieStats)
- flavor (í’ë¯¸), texture (ì‹ê°), sweetness (ë‹¬ì½¤í•¨), completion (ì™„ì„±ë„), visual (ë¹„ì£¼ì–¼)
- ì´ì  300ì  ë§Œì  (í’ë¯¸ 100 + ì‹ê° 100 + ë¹„ì£¼ì–¼/ì™„ì„±ë„ 100)

### 2. ë¯¸ë‹ˆê²Œì„ (PrepState)
- ì¹´ë‹¤ì´í”„ ì°ê¸°: Fruit Ninja ìŠ¤íƒ€ì¼ ìŠ¤ì™€ì´í”„
- í”¼ìŠ¤íƒ€ì¹˜ì˜¤ ë¶„ì‡„: íƒ€ì´ë° í„°ì¹˜ + í”¼ë²„ ëª¨ë“œ
- ë§ˆì‹œë©œë¡œìš° ë…¹ì´ê¸°: íƒ€ì´ì¿¤ ìŠ¤íƒ€ì¼ ìì› ê´€ë¦¬
  - ë¶ˆ ì¡°ì ˆ (ì•½ë¶ˆ/ì¤‘ë¶ˆ/ê°•ë¶ˆ) - ë¦¬ìŠ¤í¬ vs ë¦¬ì›Œë“œ
  - ë“¤ëŸ¬ë¶™ìŒ ë°©ì§€ - ì “ê¸° + ì—°íƒ€ë¡œ í•´ì†Œ
  - ì½”ì½”ì•„ íˆ¬ì… íƒ€ì´ë° - 40%~70%ì— íˆ¬ì…ì‹œ ë³´ë„ˆìŠ¤

### 3. íŒë§¤ ì‹œìŠ¤í…œ (SellState)
- ì‹¤ì‹œê°„ ê°€ê²© ì°¨íŠ¸ (Random Walk + ë‰´ìŠ¤ ì´ë²¤íŠ¸)
- NPC ì†ë‹˜: í•™ìƒ, í™ìŠ¤í„°, ë‘ë°”ì´ ê´€ê´‘ê°(Rare), í• ë¨¸ë‹ˆ
- ë‹¨ê³¨ ì‹œìŠ¤í…œ: í˜¸ê°ë„ 100% â†’ íŠ¹ìˆ˜ íš¨ê³¼

## Technical Notes

- **Phaser 3.80.1**: ë©”ì¸ ê²Œì„ ì—”ì§„ (v2.0.0)
- **Vanilla Canvas**: ë ˆê±°ì‹œ ì‹œìŠ¤í…œ (src/)
- **ì €ì¥**: localStorage (djjc_save, djjc_recipes, djjc_time)
- **í•´ìƒë„**: 720x1280 (Phaser), ë°˜ì‘í˜• ìŠ¤ì¼€ì¼ë§
- **í”½ì…€ ì•„íŠ¸**: `pixelArt: true`, `roundPixels: true`
- **í°íŠ¸**: DungGeunMo, Galmuri11 (GameConfig.jsì—ì„œ FONTS ì°¸ì¡°)

## Debug (ê°œë°œ ëª¨ë“œ)

ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ `window.debug` ì‚¬ìš©:
```js
debug.addGold(1000)       // ê³¨ë“œ ì¶”ê°€
debug.fillIngredients()   // ëª¨ë“  ì¬ë£Œ 100ê°œ
debug.nextDay()           // ë‹¤ìŒ ë‚ ë¡œ
debug.status()            // ìƒíƒœ ì¶œë ¥
debug.reset()             // ë¦¬ì…‹
```

## ğŸš¨ ë°˜ë³µë˜ëŠ” ì‹¤ìˆ˜ ë°©ì§€

**`progress.md` í•˜ë‹¨ì˜ "ë°˜ë³µë˜ëŠ” ì‹¤ìˆ˜ & ë²„ê·¸ í•´ê²° ê°€ì´ë“œ" ì„¹ì…˜ í•„ë…!**

ì£¼ìš” í•¨ì •:
1. **í„°ì¹˜ ì´ë²¤íŠ¸**: `touchstart` + `mousedown` ì¤‘ë³µ â†’ Phaser `pointerdown` ì‚¬ìš©
2. **State cleanup**: `exit()`ì—ì„œ íƒ€ì´ë¨¸/ë¦¬ìŠ¤ë„ˆ ë°˜ë“œì‹œ ì •ë¦¬
3. **iOS ì˜¤ë””ì˜¤**: ì²« í„°ì¹˜ì—ì„œ `AudioContext.resume()` í•„ìš”
4. **ì¢Œí‘œ ë³€í™˜**: canvas ìŠ¤ì¼€ì¼ë§ ì‹œ `getBoundingClientRect()` ì‚¬ìš©
5. **ì €ì¥ ë°ì´í„°**: `JSON.parse`ëŠ” í•­ìƒ try-catchë¡œ ê°ì‹¸ê¸°
